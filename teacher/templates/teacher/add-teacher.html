{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
<title>Preskool - Add Teacher</title>

<link rel="shortcut icon" href="{% static 'assets/img/favicon.png' %}">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,500;0,600;0,700;1,400&amp;display=swap">
<link rel="stylesheet" href="{% static 'assets/plugins/bootstrap/css/bootstrap.min.css' %}">
<link rel="stylesheet" href="{% static 'assets/plugins/fontawesome/css/fontawesome.min.css' %}">
<link rel="stylesheet" href="{% static 'assets/plugins/fontawesome/css/all.min.css' %}">
<link rel="stylesheet" href="{% static 'assets/css/style.css' %}">

<style>
    .profile-picture-preview {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        object-fit: cover;
        border: 3px solid #ddd;
        margin-bottom: 15px;
        display: none;
    }
    .profile-picture-placeholder {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        background-color: #f8f9fa;
        border: 2px dashed #dee2e6;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 15px;
        cursor: pointer;
    }
    .profile-picture-placeholder i {
        font-size: 40px;
        color: #6c757d;
    }
</style>
</head>
<body>

<div class="main-wrapper">
    <!-- Header -->
    <div class="header">
        <div class="header-left">
            <a href="{% url 'school:dashboard' %}" class="logo">
                <img src="{% static 'assets/img/logo.png' %}" alt="Logo">
            </a>
            <a href="{% url 'school:dashboard' %}" class="logo logo-small">
                <img src="{% static 'assets/img/logo-small.png' %}" alt="Logo" width="30" height="30">
            </a>
        </div>

        <a href="javascript:void(0);" id="toggle_btn">
            <i class="fas fa-align-left"></i>
        </a>

        <div class="top-nav-search">
            <form>
                <input type="text" class="form-control" placeholder="Search here">
                <button class="btn" type="submit"><i class="fas fa-search"></i></button>
            </form>
        </div>

        <a class="mobile_btn" id="mobile_btn">
            <i class="fas fa-bars"></i>
        </a>

        <ul class="nav user-menu">
            <li class="nav-item dropdown noti-dropdown">
                <a href="#" class="dropdown-toggle nav-link" data-toggle="dropdown">
                    <i class="far fa-bell"></i> <span class="badge badge-pill">3</span>
                </a>
                <div class="dropdown-menu notifications">
                    <div class="topnav-dropdown-header">
                        <span class="notification-title">Notifications</span>
                        <a href="javascript:void(0)" class="clear-noti"> Clear All </a>
                    </div>
                    <div class="noti-content">
                        <ul class="notification-list">
                            <li class="notification-message">
                                <a href="#">
                                    <div class="media">
                                        <span class="avatar avatar-sm">
                                            <img class="avatar-img rounded-circle" alt="User Image" src="{% static 'assets/img/profiles/avatar-02.jpg' %}">
                                        </span>
                                        <div class="media-body">
                                            <p class="noti-details"><span class="noti-title">Carlson Tech</span> has approved <span class="noti-title">your estimate</span></p>
                                            <p class="noti-time"><span class="notification-time">4 mins ago</span></p>
                                        </div>
                                    </div>
                                </a>
                            </li>
                            <li class="notification-message">
                                <a href="#">
                                    <div class="media">
                                        <span class="avatar avatar-sm">
                                            <img class="avatar-img rounded-circle" alt="User Image" src="{% static 'assets/img/profiles/avatar-11.jpg' %}">
                                        </span>
                                        <div class="media-body">
                                            <p class="noti-details"><span class="noti-title">International Software Inc</span> has sent you a invoice in the amount of <span class="noti-title">$218</span></p>
                                            <p class="noti-time"><span class="notification-time">6 mins ago</span></p>
                                        </div>
                                    </div>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div class="topnav-dropdown-footer">
                        <a href="#">View all Notifications</a>
                    </div>
                </div>
            </li>

            <li class="nav-item dropdown has-arrow">
                <a href="#" class="dropdown-toggle nav-link" data-toggle="dropdown">
                    {% if request.user.profile_picture %}
                        <span class="user-img"><img class="rounded-circle" src="{{ request.user.profile_picture.url }}" width="31" alt="{{ request.user.get_full_name }}"></span>
                    {% else %}
                        <span class="user-img"><img class="rounded-circle" src="{% static 'assets/img/profiles/avatar-01.jpg' %}" width="31" alt="{{ request.user.get_full_name }}"></span>
                    {% endif %}
                </a>
                <div class="dropdown-menu">
                    <div class="user-header">
                        <div class="avatar avatar-sm">
                            {% if request.user.profile_picture %}
                                <img src="{{ request.user.profile_picture.url }}" alt="User Image" class="avatar-img rounded-circle">
                            {% else %}
                                <img src="{% static 'assets/img/profiles/avatar-01.jpg' %}" alt="User Image" class="avatar-img rounded-circle">
                            {% endif %}
                        </div>
                        <div class="user-text">
                            <h6>{{ request.user.get_full_name }}</h6>
                            <p class="text-muted mb-0">{{ request.user.get_role_display }}</p>
                        </div>
                    </div>
                    {% comment %} <a class="dropdown-item" href="{% url 'home_auth:profile' %}">My Profile</a> {% endcomment %}
                    <a class="dropdown-item" href="{% url 'home_auth:logout' %}">Logout</a>
                </div>
            </li>
        </ul>
    </div>
    <!-- /Header -->

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-inner slimscroll">
            <div id="sidebar-menu" class="sidebar-menu">
                <ul>
                    <li class="menu-title">
                        <span>Main Menu</span>
                    </li>
                    <li class="submenu">
                        <a href="#"><i class="fas fa-user-graduate"></i> <span> Dashboard</span> <span class="menu-arrow"></span></a>
                        <ul>
                            <li><a href="{% url 'school:dashboard' %}">Admin Dashboard</a></li>
                            <li><a href="{% url 'school:dashboard' %}">Teacher Dashboard</a></li>
                            <li><a href="{% url 'school:dashboard' %}">Student Dashboard</a></li>
                        </ul>
                    </li>
                    <li class="submenu">
                        <a href="#"><i class="fas fa-user-graduate"></i> <span> Students</span> <span class="menu-arrow"></span></a>
                        <ul>
                            <li><a href="{% url 'student:student-list' %}">Student List</a></li>
                            <li><a href="{% url 'student:add-student' %}">Student Add</a></li>
                        </ul>
                    </li>
                    <li class="submenu active">
                        <a href="#"><i class="fas fa-chalkboard-teacher"></i> <span> Teachers</span> <span class="menu-arrow"></span></a>
                        <ul>
                            <li><a href="{% url 'teacher:list-teachers' %}">Teacher List</a></li>
                            <li><a href="{% url 'teacher:add-teacher' %}" class="active">Teacher Add</a></li>
                        </ul>
                    </li>
                    <li class="submenu">
                        <a href="#"><i class="fas fa-building"></i> <span> Departments</span> <span class="menu-arrow"></span></a>
                        <ul>
                            <li><a href="{% url 'department:list-department' %}">Department List</a></li>
                            <li><a href="{% url 'department:add-department' %}">Department Add</a></li>
                        </ul>
                    </li>
                    <!-- Simplified other menu items -->
                    <li class="menu-title">
                        <span>Management</span>
                    </li>
                    <li>
                        <a href="#"><i class="fas fa-holly-berry"></i> <span>Holiday</span></a>
                    </li>
                    <li>
                        <a href="#"><i class="fas fa-clipboard-list"></i> <span>Exam list</span></a>
                    </li>
                    <li>
                        <a href="#"><i class="fas fa-calendar-day"></i> <span>Events</span></a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <!-- /Sidebar -->

    <!-- Page Wrapper -->
    <div class="page-wrapper">
        <div class="content container-fluid">
            <!-- Page Header -->
            <div class="page-header">
                <div class="row align-items-center">
                    <div class="col">
                        <h3 class="page-title">Add Teacher</h3>
                        <ul class="breadcrumb">
                            <li class="breadcrumb-item"><a href="{% url 'teacher:list-teachers' %}">Teachers</a></li>
                            <li class="breadcrumb-item active">Add Teacher</li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- /Page Header -->

            <div class="row">
                <div class="col-sm-12">
                    <div class="card">
                        <div class="card-body">
                            <form method="POST" action="{% url 'teacher:add-teacher' %}" enctype="multipart/form-data">
                                {% csrf_token %}
                                
                                <!-- Display form errors if any -->
                                {% if form.errors %}
                                <div class="alert alert-danger">
                                    <strong>Please correct the errors below:</strong>
                                    <ul>
                                        {% for field, errors in form.errors.items %}
                                            {% for error in errors %}
                                                <li>{{ field|title }}: {{ error }}</li>
                                            {% endfor %}
                                        {% endfor %}
                                    </ul>
                                </div>
                                {% endif %}
                                
                                <div class="row">
                                    <div class="col-12">
                                        <h5 class="form-title"><span>Profile Picture</span></h5>
                                    </div>
                                    
                                    <div class="col-12 text-center mb-4">
                                        <img id="profile-picture-preview" class="profile-picture-preview" src="#" alt="Profile preview">
                                        <div id="profile-picture-placeholder" class="profile-picture-placeholder">
                                            <i class="fas fa-camera"></i>
                                        </div>
                                        <input type="file" id="profile_picture" name="profile_picture" accept="image/*" style="display: none;">
                                        <div class="text-muted small mt-2">Click to upload a profile picture (JPG, PNG, GIF - Max 2MB)</div>
                                    </div>
                                    
                                    <div class="col-12">
                                        <h5 class="form-title"><span>Basic Details</span></h5>
                                    </div>
                                    <div class="col-12 col-sm-6">
                                        <div class="form-group">
                                            <label>First Name *</label>
                                            <input type="text" class="form-control" name="first_name" value="{{ form.first_name.value|default:'' }}" required>
                                        </div>
                                    </div>
                                    <div class="col-12 col-sm-6">
                                        <div class="form-group">
                                            <label>Last Name *</label>
                                            <input type="text" class="form-control" name="last_name" value="{{ form.last_name.value|default:'' }}" required>
                                        </div>
                                    </div>
                                    <div class="col-12 col-sm-6">
                                        <div class="form-group">
                                            <label>Gender *</label>
                                            <select class="form-control" name="gender" required>
                                                <option value="">Select Gender</option>
                                                <option value="M" {% if form.gender.value == 'M' %}selected{% endif %}>Male</option>
                                                <option value="F" {% if form.gender.value == 'F' %}selected{% endif %}>Female</option>
                                                <option value="O" {% if form.gender.value == 'O' %}selected{% endif %}>Other</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-12 col-sm-6">
                                        <div class="form-group">
                                            <label>Date of Birth *</label>
                                            <input type="date" class="form-control" name="date_of_birth" value="{{ form.date_of_birth.value|default:'' }}" required>
                                        </div>
                                    </div>
                                    <div class="col-12 col-sm-6">
                                        <div class="form-group">
                                            <label>Mobile *</label>
                                            <input type="text" class="form-control" name="mobile" value="{{ form.mobile.value|default:'' }}" required>
                                        </div>
                                    </div>
                                    <div class="col-12 col-sm-6">
                                        <div class="form-group">
                                            <label>Department *</label>
                                            <select class="form-control" name="department" required>
                                                <option value="">Select Department</option>
                                                {% for department in departments %}
                                                    <option value="{{ department.id }}" {% if form.department.value == department.id %}selected{% endif %}>{{ department.name }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-12 col-sm-6">
                                        <div class="form-group">
                                            <label>Joining Date *</label>
                                            <input type="date" class="form-control" name="joining_date" value="{{ form.joining_date.value|default:'' }}" required>
                                        </div>
                                    </div>
                                    <div class="col-12 col-sm-6">
                                        <div class="form-group">
                                            <label>Qualification *</label>
                                            <input class="form-control" type="text" name="qualification" value="{{ form.qualification.value|default:'' }}" required>
                                        </div>
                                    </div>
                                    <div class="col-12 col-sm-6">
                                        <div class="form-group">
                                            <label>Experience (Years) *</label>
                                            <input class="form-control" type="number" name="experience" value="{{ form.experience.value|default:'' }}" min="0" step="0.1" required>
                                        </div>
                                    </div>
                                    
                                    <div class="col-12">
                                        <h5 class="form-title"><span>Login Details</span></h5>
                                    </div>
                                    <div class="col-12 col-sm-6">
                                        <div class="form-group">
                                            <label>Email ID *</label>
                                            <input type="email" class="form-control" name="email" value="{{ form.email.value|default:'' }}" required>
                                        </div>
                                    </div>
                                    <div class="col-12 col-sm-6">
                                        <div class="form-group">
                                            <label>Password *</label>
                                            <input type="password" class="form-control" name="password" required>
                                        </div>
                                    </div>
                                    <div class="col-12 col-sm-6">
                                        <div class="form-group">
                                            <label>Repeat Password *</label>
                                            <input type="password" class="form-control" name="repeat_password" required>
                                        </div>
                                    </div>
                                    
                                    <div class="col-12">
                                        <h5 class="form-title"><span>Address</span></h5>
                                    </div>
                                    <div class="col-12">
                                        <div class="form-group">
                                            <label>Address *</label>
                                            <input type="text" class="form-control" name="address" value="{{ form.address.value|default:'' }}" required>
                                        </div>
                                    </div>
                                    <div class="col-12 col-sm-6">
                                        <div class="form-group">
                                            <label>City *</label>
                                            <input type="text" class="form-control" name="city" value="{{ form.city.value|default:'' }}" required>
                                        </div>
                                    </div>
                                    <div class="col-12 col-sm-6">
                                        <div class="form-group">
                                            <label>Zip Code *</label>
                                            <input type="text" class="form-control" name="zipcode" value="{{ form.zipcode.value|default:'' }}" required>
                                        </div>
                                    </div>
                                    <div class="col-12 col-sm-6">
                                        <div class="form-group">
                                            <label>Country *</label>
                                            <input type="text" class="form-control" name="country" value="{{ form.country.value|default:'' }}" required>
                                        </div>
                                    </div>
                                    
                                    <div class="col-12 mt-3">
                                        <button type="submit" class="btn btn-primary">Add Teacher</button>
                                        <a href="{% url 'teacher:list-teachers' %}" class="btn btn-secondary">Cancel</a>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /Page Wrapper -->

    <footer>
        <p>Copyright © 2020 Dreamguys.</p>
    </footer>
</div>

<!-- Scripts -->
<script src="{% static 'assets/js/jquery-3.6.0.min.js' %}"></script>
<script src="{% static 'assets/js/popper.min.js' %}"></script>
<script src="{% static 'assets/plugins/bootstrap/js/bootstrap.min.js' %}"></script>
<script src="{% static 'assets/plugins/slimscroll/jquery.slimscroll.min.js' %}"></script>
<script src="{% static 'assets/js/script.js' %}"></script>

<!-- Image Preview Script -->
<script>
    $(document).ready(function() {
        // Profile picture preview
        $('#profile-picture-placeholder').click(function() {
            $('#profile_picture').click();
        });
        
        $('#profile_picture').change(function() {
            if (this.files && this.files[0]) {
                var reader = new FileReader();
                
                reader.onload = function(e) {
                    $('#profile-picture-preview').attr('src', e.target.result).show();
                    $('#profile-picture-placeholder').hide();
                }
                
                reader.readAsDataURL(this.files[0]);
            }
        });
        
        // Form validation
        $('form').on('submit', function(e) {
            const password = $('input[name="password"]').val();
            const repeatPassword = $('input[name="repeat_password"]').val();
            
            if (password !== repeatPassword) {
                e.preventDefault();
                alert('Passwords do not match!');
                return false;
            }
            
            if (password.length < 6) {
                e.preventDefault();
                alert('Password must be at least 6 characters long!');
                return false;
            }
            
            // Validate file size (max 2MB)
            const fileInput = $('#profile_picture')[0];
            if (fileInput.files.length > 0) {
                const fileSize = fileInput.files[0].size / 1024 / 1024; // in MB
                if (fileSize > 2) {
                    e.preventDefault();
                    alert('Profile picture must be less than 2MB!');
                    return false;
                }
            }
        });
    });
</script>

</body>
</html>